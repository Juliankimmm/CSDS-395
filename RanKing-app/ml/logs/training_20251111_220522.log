2025-11-11 22:05:22,530 | INFO | Training started - Log file: ./logs\training_20251111_220522.log
2025-11-11 22:05:22,531 | INFO | Arguments: {'train_dir': './datasets/train', 'val_dir': './datasets/val', 'cache_images': False, 'img_size': 384, 'resize_schedule': '256,320,384', 'clip_weight': 0.15, 'dropout': 0.4, 'freeze_backbone': 0, 'use_attention': False, 'lr': 5e-05, 'weight_decay': 0.0001, 'batch_size': 16, 'epochs': 20, 'accum_steps': 2, 'num_workers': 4, 'focal_gamma': 0.5, 'cb_beta': 0.99, 'smoothing_safe': 0.05, 'smoothing_unsafe': 0.2, 'minority_oversample_factor': 3.0, 'curriculum_epochs': 3, 'mixup_alpha': 0.2, 'cutmix_alpha': 0.5, 'use_mixup': False, 'scheduler_t0': 5, 'swa_start': 10, 'tta': False, 'early_stopping_patience': 5, 'early_stopping_min_delta': 0.001, 'checkpoint_dir': './checkpoints', 'keep_checkpoints': 3, 'resume': False, 'save_model': './models/moderation_model_best.pth', 'log_dir': './logs'}
2025-11-11 22:05:22,806 | INFO | Class Distribution (train):
2025-11-11 22:05:22,806 | INFO |    Safe (0):   92,147 samples
2025-11-11 22:05:22,806 | INFO |    Unsafe (1): 301 samples
2025-11-11 22:05:22,806 | INFO |    Imbalance ratio: 306.1:1
2025-11-11 22:05:22,879 | INFO | Class-balanced weights: [0.9751208 1.0248792]
2025-11-11 22:05:27,384 | INFO | No checkpoint found, starting from scratch
2025-11-11 22:05:27,384 | INFO | Starting training from epoch 0
2025-11-11 22:05:27,384 | INFO |    Total epochs: 20
2025-11-11 22:05:27,385 | INFO |    Curriculum phase: 3 epochs
2025-11-11 22:05:27,385 | INFO |    Device: cuda
2025-11-11 22:05:27,386 | INFO | 
Epoch 1/20 | BALANCED | Size: 256px
